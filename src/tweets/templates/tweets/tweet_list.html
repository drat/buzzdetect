{% extends 'admin/base.html' %}

{% load humanize %}
{% load tz %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'tweets:tweet_list' %}?anytime=1">All tweets</a>
    /
    <a href="{% url 'tweets:tweet_list' %}">Recent tweets</a>
</div>
{% endblock %}

{% block branding %}
{% timezone "Europe/Paris" %}

<h1>
Tweets
{% if 'anytime' not in request.GET %}
since {{ min_datetime }}
{% endif %}
with at least {{ min_friends_retweets }} friends retweet
</h1>

{% endtimezone %}
{% endblock %}

{% block content %}
{% for tweet in tweets %}
<div class="tweet">
    <div class="source">
        <a href="https://twitter.com/users/{{ tweet.source.id }}">{{ tweet.source }}</a>
    </div>
    <div class="body">
        {{ tweet.text }}
    </div>
    <div class="link">
        <a
            href="https://twitter.com/statuses/{{ tweet.id }}"
        >https://twitter.com/statuses/{{ tweet.id }}</a>
    </div>
    <div class="stats">
        <table>
            <tr>
                <td>
                    {{ tweet.datetime|naturaltime }}
                </td>
                <td>
                    Friends retweets
                </td>
                <td>
                    {{ tweet.friends_retweets }}
                </td>
                <td>
                    Total retweet per minute
                </td>
                <td>
                    {{ tweet.total_rtm }}
                </td>
                <td>
                    Acceleration
                </td>
                <td>
                    {{ tweet.last_retweets.acceleration }}
                </td>
            </tr>
        </table>
    </div>
</div>
{% empty %}
<h1>No matching tweet found</h1>

{% if 'anytime' not in request.GET %}
<p>
<a href="?anytime=1">See the complete list</a>
</p>
{% endif %}
{% endfor %}

<script type="text/javascript">
function reload() {
    window.location.reload();
    setTimeout(reload, 1500);
}

setTimeout(reload, 1500);
</script>
{% endblock %}
